{% extends 'base.html' %}
{% block title %}Abschnitt bearbeiten{% endblock %}
{% block content %}
<h4 class="mb-3">Abschnitt bearbeiten</h4>
<form method="post" action="/courses/{{ course_id }}/section/{{ node.id }}/save">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  <div class="mb-3">
    <label class="form-label">Titel</label>
    <input class="form-control" name="title" value="{{ node.title }}" required>
  </div>
  <div class="mb-3">
    <label class="form-label">Inhalt</label>
    <div id="editor" style="height: 420px; background: #fff;"></div>
    <input type="hidden" id="body_html" name="body_html">
  </div>
  <button class="btn btn-primary" onclick="beforeSubmit()">Speichern</button>
</form>

<link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
<script>
const quill = new Quill('#editor', {
  theme: 'snow',
  modules: {
    toolbar: [
      [{ header: [1, 2, 3, false] }],
      ['bold', 'italic', 'underline', 'strike'],
      [{ 'list': 'ordered'}, { 'list': 'bullet' }],
      [{ 'align': [] }],
      ['link', 'image', 'video'],
      ['clean']
    ]
  }
});
// initial HTML in Editor laden
const initial = `{% filter forceescape %}{{ node.body_html or '' }}{% endfilter %}`;
quill.root.innerHTML = initial;

function beforeSubmit(){
  document.getElementById('body_html').value = quill.root.innerHTML;
}
</script>
{% endblock %}
